<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>POST-TEST</title>
  <style>
    body {
      font-family: 'Leelawadee UI';
      text-align: center;
      padding: 60px;
      background-image: url('Picwater2.jpg'); 
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .container {
      background-color: #ffffff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      max-width: 90%;
      height: 90%;
      margin: auto;
    }

    h2 {
      color: #60B5FF;
      margin-bottom: 20px;
    }

    .question {
      padding-top: 30px;
      font-size: 30px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #484966;
    }

    .options-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 30px;
      justify-items: center;
    }

    .option-btn {
      width: 95%;       
      min-height: 120px;  
      padding: 10px;
      margin: 10px;     
      background-color: #afccd3;
      color: white;   
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 20px;   
      transition: background-color 0.2s ease;
    }

  .option-btn:hover {
      background-color:#6d7e83;
    }

    @media (max-width: 480px) {
      .options-container {
        grid-template-columns: 1fr;
      }
    } 
  </style>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

</head>
<body>

  <div class="container">
    <img src="TITLE2.png" alt="Welcome Image" style="width: 200%; max-width: 400px; border-radius: 15px;">
    <div id="question" class="question">คำถามจะปรากฏตรงนี้</div>
    <div id="options" class="options-container"></div>
  </div>

  <script>
    // Firebase config ของคุณ
    const firebaseConfig = {
      apiKey: "AIzaSyDzY4p78Gk0HhCwNPBdPYC4I8arT6CUFgo",
      authDomain: "healer-wating.firebaseapp.com",
      projectId: "healer-wating",
      storageBucket: "healer-wating.firebasestorage.app",
      messagingSenderId: "723339403882",
      appId: "1:723339403882:web:3f23f47a9cedce6e69e013",
      measurementId: "G-JNCLBF382P"
    };

    // เริ่ม Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const questions = [
      {
        question: "การบำบัดน้ำเสียมีความสำคัญอย่างไร?",
        options: [
          { text: "เพื่อเพิ่มจำนวนปลาน้ำจืด", value: "A" },
          { text: "เพื่อควบคุมระดับน้ำในแม่น้ำ", value: "B" },
          { text: "เพื่อลดมลพิษก่อนปล่อยลงแหล่งน้ำ", value: "C" },
          { text: "เพื่อผลิตไฟฟ้า", value: "D" }
        ],
        answer: "C"
      },
      {
        question: "กระบวนการใดต่อไปนี้ใช้ในการบำบัดน้ำเสีย?",
        options: [
          { text: "การระเหย", value: "A" },
          { text: "การตากแดด", value: "B" },
          { text: "การเติมอากาศ (Aeration)", value: "C" },
          { text: "การกรองด้วยทรายเพียงอย่างเดียว", value: "D" }
        ],
        answer: "C"
      },
      {
        question: "ข้อใดเป็นหน่วยงานที่มีหน้าที่ดูแลและควบคุมการบำบัดน้ำเสียในประเทศไทยเป็นหลัก?",
        options: [
          { text: "กระทรวงทรัพยากรธรรมชาติและสิ่งแวดล้อม", value: "A" },
          { text: "กรมควบคุมมลพิษ", value: "B" },
          { text: "กรมการเปลี่ยนแปลงสภาพภูมิอากาศและสิ่งแวดล้อม", value: "C" },
          { text: "กรมทรัพยากรน้ำบาดาล", value: "D" }
        ],
        answer: "B"
      },
      {
        question: "ข้อใดสอดคล้องน้อยที่สุดกับแนวทางการแก้ไขปัญหาน้ำเสียของแหล่งน้ำทั้ง 3 แห่งที่กล่าวมา?",
        options: [
          { text: "การวางระบบรวบรวมและบำบัดน้ำเสียจากชุมชนเป็นวิธีที่ใช้ในคลองแสนแสบและคลองเปรมประชากร", value: "A" },
          { text: "การบำบัดน้ำเสียโดยใช้พืชเป็นแนวทางหลักของโครงการที่คลองเปรมประชากร", value: "B" },
          { text: "บึงมักกะสันใช้ทั้งวิธีธรรมชาติและเครื่องกลในการฟื้นฟูคุณภาพน้ำ", value: "C" },
          { text: "โครงการบำบัดน้ำเสียมีนบุรีมีขีดความสามารถในการรองรับน้ำเสียมากกว่า 50,000 ลบ.ม./วัน", value: "D" }
        ],
        answer: "B"
      },
      {
        question: "จากสถานการณ์น้ำเสียในกรุงเทพมหานคร ต่อไปนี้ข้อใดเป็นเหตุผลหลักที่ทำให้โครงการบำบัดน้ำเสียในพื้นที่บริเวณมีนบุรีเน้นการติดตั้งระบบบำบัดน้ำเสียรายครัวเรือนควบคู่กับระบบบำบัดรวมชุมชน?",
        options: [
          { text: "น้ำเสียในพื้นที่นี้มีปริมาณน้อยและกระจายตัว ทำให้ระบบบำบัดรวมไม่คุ้มค่าต่อการลงทุน", value: "A" },
          { text: "น้ำเสียส่วนใหญ่เกิดจากโรงงานอุตสาหกรรมที่ต้องการการบำบัดเฉพาะจุด", value: "B" },
          { text: "น้ำเสียจากครัวเรือน เช่น ห้องน้ำ ห้องครัว และซักล้าง ถูกปล่อยลงคลองโดยตรงโดยไม่มีระบบบำบัดในระดับชุมชน", value: "C" },
          { text: "มีแหล่งน้ำธรรมชาติขนาดใหญ่ที่สามารถเจือจางน้ำเสียได้โดยไม่ต้องมีระบบบำบัด", value: "D" }
        ],
        answer: "C"  
      }
    ];

    let currentQuestion = 0;
    let score = 0;

    function showQuestion() {
      const q = questions[currentQuestion];
      document.getElementById('question').textContent = q.question;

      const optionsDiv = document.getElementById('options');
      optionsDiv.innerHTML = "";

      q.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = opt.text;
        btn.onclick = () => {
          // เช็คคำตอบ (ไม่สนใจตัวพิมพ์เล็ก/ใหญ่)
          if (opt.value.toUpperCase() === q.answer.toUpperCase()) {
            score++;
          }
          currentQuestion++;
          if (currentQuestion < questions.length) {
            showQuestion();
          } else {
            // ส่งคะแนนไป Firestore ก่อนเปลี่ยนหน้า
            db.collection("quizResults").add({
              timestamp: firebase.firestore.FieldValue.serverTimestamp(),
              score: score,
              total: questions.length
            })
            .then(() => {
              // ส่งเสร็จแล้วเปลี่ยนหน้า
              window.location.href = `home.html?score=${score}`;
            })
            .catch((error) => {
              console.error("ส่งข้อมูลล้มเหลว: ", error);
              alert("เกิดข้อผิดพลาดในการบันทึกคะแนน");
            });
          }
        };
        optionsDiv.appendChild(btn);
      });
    }

    showQuestion();
  </script>

</body>
</html>


